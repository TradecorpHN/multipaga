import{c as D,u as I,r as n,j as e,S as f,L as g}from"./index-BWBdPVw1.js";import{B as v}from"./button-D0HiSPgI.js";import{I as y}from"./input-DlQeWTVt.js";import{L as j}from"./label-DY-KjiXk.js";import{A as L,a as T}from"./alert-Dlt_bX8N.js";import{A as E}from"./arrow-left-BHPuKUeV.js";import{S as F}from"./smartphone-iH9j7X-E.js";import"./index-C5vqZNo1.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],$=D("key",R),U=({onBack:u})=>{const{verifyTOTP:w,verifyRecoveryCode:N,loading:i,error:m,clearError:l}=I(),[o,p]=n.useState("totp"),[r,c]=n.useState(""),[d,x]=n.useState(["","","","","",""]);n.useEffect(()=>{l()},[o,l]);const k=(t,s)=>{if(s.length>1)return;const a=[...d];if(a[t]=s,x(a),s&&t<5){const b=document.getElementById(`digit-${t+1}`);b&&b.focus()}c(a.join("")),l()},C=(t,s)=>{if(s.key==="Backspace"&&!d[t]&&t>0){const a=document.getElementById(`digit-${t-1}`);a&&a.focus()}},A=async t=>{t.preventDefault(),r.length===6&&await w(r)},S=async t=>{t.preventDefault(),r.trim()&&await N(r.trim())},h=()=>{c(""),x(["","","","","",""]),l()};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse delay-1000"}),e.jsx("div",{className:"absolute bottom-1/4 left-1/3 w-96 h-96 bg-cyan-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse delay-2000"})]}),e.jsx("div",{className:"relative w-full max-w-md",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-2xl p-8 relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-cyan-500/20 blur-sm"}),e.jsxs("div",{className:"relative",children:[u&&e.jsx("button",{onClick:u,className:"absolute -top-2 -left-2 p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200",children:e.jsx(E,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("div",{className:"inline-block bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-lg",children:e.jsx(f,{className:"h-8 w-8 text-blue-600 mx-auto"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Verificación 2FA"}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Ingresa tu código de autenticación"})]})]}),e.jsxs("div",{className:"flex mb-6 bg-white/5 backdrop-blur-sm rounded-xl p-1",children:[e.jsxs("button",{type:"button",onClick:()=>{p("totp"),h()},className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-lg text-sm font-medium transition-all duration-200 ${o==="totp"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-blue-200 hover:text-white hover:bg-white/10"}`,children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:"Código TOTP"})]}),e.jsxs("button",{type:"button",onClick:()=>{p("recovery"),h()},className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-lg text-sm font-medium transition-all duration-200 ${o==="recovery"?"bg-gradient-to-r from-purple-500 to-cyan-500 text-white shadow-lg":"text-blue-200 hover:text-white hover:bg-white/10"}`,children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:"Código de Recuperación"})]})]}),m&&e.jsx(L,{className:"mb-6 bg-red-500/20 border-red-400/30",children:e.jsx(T,{className:"text-red-200",children:m})}),o==="totp"?e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"text-white text-sm font-medium flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-400 rounded-full"}),"Código de 6 dígitos"]}),e.jsx("div",{className:"flex space-x-2 justify-center",children:d.map((t,s)=>e.jsx(y,{id:`digit-${s}`,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:"1",value:t,onChange:a=>k(s,a.target.value.replace(/\D/g,"")),onKeyDown:a=>C(s,a),className:"w-12 h-12 text-center text-lg font-bold bg-white/10 backdrop-blur-sm border border-white/20 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-200 hover:bg-white/15"},s))}),e.jsx("p",{className:"text-xs text-blue-300 text-center mt-2",children:"Ingresa el código de 6 dígitos de tu app de autenticación"})]}),e.jsxs(v,{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-500 hover:from-blue-600 hover:via-purple-600 hover:to-cyan-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-lg hover:shadow-blue-500/25 disabled:opacity-50 disabled:transform-none relative overflow-hidden",disabled:i||r.length!==6,children:[e.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2",children:[i&&e.jsx(g,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:i?"Verificando...":"Verificar Código"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 opacity-0 hover:opacity-100 transition-opacity duration-300"})]})]}):e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{htmlFor:"recovery-code",className:"text-white text-sm font-medium flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-400 rounded-full"}),"Código de Recuperación"]}),e.jsx(y,{id:"recovery-code",type:"text",placeholder:"Ingresa tu código de recuperación",value:r,onChange:t=>{c(t.target.value),l()},className:"w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 text-white placeholder-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-200 hover:bg-white/15",required:!0}),e.jsx("p",{className:"text-xs text-blue-300 text-center mt-2",children:"Usa uno de tus códigos de recuperación de respaldo"})]}),e.jsxs(v,{type:"submit",className:"w-full bg-gradient-to-r from-purple-500 via-cyan-500 to-blue-500 hover:from-purple-600 hover:via-cyan-600 hover:to-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-lg hover:shadow-purple-500/25 disabled:opacity-50 disabled:transform-none relative overflow-hidden",disabled:i||!r.trim(),children:[e.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2",children:[i&&e.jsx(g,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:i?"Verificando...":"Usar Código de Recuperación"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600 via-cyan-600 to-blue-600 opacity-0 hover:opacity-100 transition-opacity duration-300"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-white/5 backdrop-blur-sm rounded-xl border border-white/10",children:[e.jsxs("p",{className:"text-xs text-blue-200 text-center",children:[e.jsx(f,{className:"h-3 w-3 inline mr-1"}),"Autenticación de Dos Factores Activa"]}),e.jsx("p",{className:"text-xs text-blue-300 text-center mt-1",children:"Tu cuenta está protegida con 2FA"})]}),e.jsxs("div",{className:"mt-6 flex justify-center space-x-4",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-ping"}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-ping delay-100"}),e.jsx("div",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-ping delay-200"})]})]})]})})]})};export{U as default};
