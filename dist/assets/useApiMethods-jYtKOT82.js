import{r as o,e as C,u as I}from"./index-BWBdPVw1.js";const i={CUSTOMERS:"CUSTOMERS",V2_CONNECTOR:"V2_CONNECTOR",V2_ATTEMPTS_LIST:"V2_ATTEMPTS_LIST",V2_ORDERS_LIST:"V2_ORDERS_LIST",PAYMENT_METHOD_LIST:"PAYMENT_METHOD_LIST",RETRIEVE_PAYMENT_METHOD:"RETRIEVE_PAYMENT_METHOD",V2_ORDER_FILTERS:"V2_ORDER_FILTERS",V2_ORDERS_AGGREGATE:"V2_ORDERS_AGGREGATE",USERS:"USERS",TOTAL_TOKEN_COUNT:"TOTAL_TOKEN_COUNT"},N={NONE:"NONE",MERCHANT:"MERCHANT",PROFILE:"PROFILE",ORGANIZATION:"ORGANIZATION"},h={MERCHANT:"Merchant",PROFILE:"Profile",ORGANIZATION:"Organization"},_={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"},L={SANDBOX:"https://sandbox.hyperswitch.io",PRODUCTION:"https://api.hyperswitch.io"},U=({entityName:t,userType:a=N.NONE,methodType:r,id:e=null,profileId:u,merchantId:l,transactionEntity:E,queryParameters:n=null})=>{const c="v2/connector-accounts",s="v2/payments";switch(t){case i.CUSTOMERS:switch(r){case _.GET:return e?`v2/customers/${e}`:"v2/customers/list";default:return""}case i.V2_CONNECTOR:switch(r){case _.GET:return e?`${c}/${e}`:`v2/profiles/${u}/connector-accounts`;case _.PUT:case _.POST:return e?`${c}/${e}`:c;default:return""}case i.V2_ORDERS_LIST:switch(r){case _.GET:return e?n?`${s}/${e}?${n}`:`${s}/${e}/get-intent`:n?`${s}/list?${n}`:`${s}/list?limit=100`;default:return""}case i.V2_ATTEMPTS_LIST:switch(r){case _.GET:return e?`${s}/${e}/list_attempts`:"";default:return""}case"PROCESS_TRACKER":switch(r){case _.GET:return e?`v2/process_tracker/revenue_recovery_workflow/${e}`:"v2/process_tracker/revenue_recovery_workflow";default:return""}case i.V2_ORDER_FILTERS:return"v2/payments/profile/filter";case i.V2_ORDERS_AGGREGATE:switch(r){case _.GET:if(n)switch(E){case h.MERCHANT:return`v2/payments/aggregate?${n}`;case h.PROFILE:return`v2/payments/profile/aggregate?${n}`;default:return`v2/payments/aggregate?${n}`}return"";default:return""}case i.PAYMENT_METHOD_LIST:return e?`v2/customers/${e}/saved-payment-methods`:"";case i.TOTAL_TOKEN_COUNT:return"v2/customers/total-payment-methods";case i.RETRIEVE_PAYMENT_METHOD:return e?`v2/payment-methods/${e}`:"";case"MERCHANT_ACCOUNT":return`v2/merchant-accounts/${l}`;case i.USERS:const T="user";switch(a){case"CREATE_MERCHANT":return n?`v2/${T}/create_merchant?${n}`:`v2/${T}/create_merchant`;case"LIST_MERCHANT":return`v2/${T}/list/merchant`;case"SWITCH_MERCHANT_NEW":return`v2/${T}/switch/merchant`;case"LIST_PROFILE":return`v2/${T}/list/profile`;default:return""}case"API_KEYS":switch(r){case _.GET:return"v2/api-keys/list";case _.POST:case _.PUT:case _.DELETE:return e?`v2/api-keys/${e}`:"v2/api-keys";default:return""}default:return""}switch(t){case i.CUSTOMERS:switch(r){case"GET":return e?`v2/customers/${e}`:"v2/customers/list";default:return""}case i.V2_CONNECTOR:switch(r){case"GET":return e?`${c}/${e}`:`v2/profiles/${u}/connector-accounts`;case"PUT":case"POST":return e?`${c}/${e}`:c;default:return""}case i.V2_ORDERS_LIST:switch(r){case"GET":return e?n?`${s}/${e}?${n}`:`${s}/${e}/get-intent`:n?`${s}/list?${n}`:`${s}/list?limit=100`;default:return""}case i.V2_ATTEMPTS_LIST:switch(r){case"GET":return e?`${s}/${e}/list_attempts`:"";default:return""}case i.PROCESS_TRACKER:switch(r){case"GET":return e?`v2/process_tracker/revenue_recovery_workflow/${e}`:"v2/process_tracker/revenue_recovery_workflow";default:return""}case i.V2_ORDER_FILTERS:return"v2/payments/profile/filter";case i.V2_ORDERS_AGGREGATE:switch(r){case"GET":if(n)switch(E){case h.MERCHANT:return`v2/payments/aggregate?${n}`;case h.PROFILE:return`v2/payments/profile/aggregate?${n}`;default:return`v2/payments/aggregate?${n}`}return"";default:return""}case i.PAYMENT_METHOD_LIST:return e?`v2/customers/${e}/saved-payment-methods`:"";case i.TOTAL_TOKEN_COUNT:return"v2/customers/total-payment-methods";case i.RETRIEVE_PAYMENT_METHOD:return e?`v2/customers/payment-methods/${e}`:"";default:return""}},m=({uri:t,headers:a={},contentType:r="application/json",xFeatureRoute:e=!0,token:u,merchantId:l,profileId:E,version:n="V1"})=>{if(t.includes("mixpanel"))return{"Content-Type":"application/x-www-form-urlencoded",accept:"application/json"};const s={...a};return u&&(n==="V1"?(s.authorization=`Bearer ${u}`,s["api-key"]="hyperswitch"):n==="V2"&&(s.authorization=`Bearer ${u}`)),r&&(s["Content-Type"]=r),e&&(t.includes("lottie-files")||t.includes("config/merchant")||t.includes("config/feature")?s["Content-Type"]="application/json":s["x-feature"]="integ-custom"),t.includes("dynamic-routing")&&(s["x-feature"]="dynamo-simulator"),E&&(s["X-Profile-Id"]=E),l&&(s["X-Merchant-Id"]=l),s},G=(t,a)=>`${t}/${a}`,V=async t=>{if(!t.ok){const r=await t.json().catch(()=>({}));throw new Error(`HTTP ${t.status}: ${r.message||t.statusText}`)}const a=t.headers.get("content-type");return a&&a.includes("application/json")?await t.json():await t.text()},b=t=>{if(console.error("API Error:",t),t.message.includes("401")){localStorage.clear(),window.location.href="/login";return}throw t},R={V2_ENTITY_TYPES:i,USER_TYPES:N,TRANSACTION_ENTITY:h,BASE_URLS:L,getV2Url:U,getHeaders:m,buildFullUrl:G,handleResponse:V,handleApiError:b},k=()=>{const[t,a]=o.useState(0),r=t>0,e=o.useCallback(()=>{a(l=>l+1)},[]),u=o.useCallback(()=>{a(l=>Math.max(0,l-1))},[]);return{isLoading:r,pendingRequests:t,incrementProgress:e,decrementProgress:u}},w=()=>{const{token:t,setAuthStateToLogout:a}=I(),{merchantInfo:r,profileInfo:e}=C(),{incrementProgress:u,decrementProgress:l}=k();return o.useCallback(async({uri:n,bodyStr:c="",bodyFormData:s=null,headers:T={},method:S="GET",contentType:g="application/json",xFeatureRoute:f=!0,forceCookies:d=!1,merchantId:v=(r==null?void 0:r.merchant_id)||"",profileId:M=(e==null?void 0:e.profile_id)||"",version:P="V1"})=>{try{u();const O=R.getHeaders({uri:n,headers:T,contentType:g,xFeatureRoute:f,token:t,merchantId:v,profileId:M,version:P});let p=null;S!=="GET"&&(s?(p=s,delete O["Content-Type"]):c&&(p=c));const $={method:S,headers:O,credentials:d?"same-origin":"omit"};p&&($.body=p);const A=await fetch(n,$);return A.status===401&&(a(),window.location.href="/login"),A}catch(O){throw console.error("API Fetcher Error:",O),O}finally{l()}},[t,r,e,a,u,l])},H=()=>{const t=w(),[a,r]=o.useState(!1),[e,u]=o.useState(null),l=o.useRef(null),E=o.useCallback(async(c,s={})=>{try{r(!0),u(null),l.current&&l.current.abort(),l.current=new AbortController;const T=await t({uri:c,method:"GET",...s});return await R.handleResponse(T)}catch(T){throw T.name!=="AbortError"&&(u(T),R.handleApiError(T)),T}finally{r(!1)}},[t]),n=o.useCallback(()=>{l.current&&l.current.abort()},[]);return{getMethod:E,loading:a,error:e,cancelRequest:n}},F=()=>{const t=w(),[a,r]=o.useState(!1),[e,u]=o.useState(null);return{updateMethod:o.useCallback(async(E,n={})=>{try{r(!0),u(null);const c=await t({uri:E,method:"POST",...n});return await R.handleResponse(c)}catch(c){throw u(c),R.handleApiError(c),c}finally{r(!1)}},[t]),loading:a,error:e}},x=()=>{const{merchantInfo:t,profileInfo:a}=C();return{buildUrl:o.useCallback((e,u={})=>{const l=R.BASE_URLS.SANDBOX,E={entityName:e,merchantId:t==null?void 0:t.merchant_id,profileId:a==null?void 0:a.profile_id,...u},n=R.getV2Url(E);return R.buildFullUrl(l,n)},[t,a])}},y=(t=1,a=10)=>{const[r,e]=o.useState(t),[u,l]=o.useState(a),[E,n]=o.useState(0),c=Math.ceil(E/u),s=o.useCallback(f=>{f>=1&&f<=c&&e(f)},[c]),T=o.useCallback(()=>{s(r+1)},[r,s]),S=o.useCallback(()=>{s(r-1)},[r,s]),g=o.useCallback(f=>{l(f),e(1)},[]);return{currentPage:r,pageSize:u,totalItems:E,totalPages:c,setTotalItems:n,goToPage:s,goToNextPage:T,goToPreviousPage:S,changePageSize:g,hasNextPage:r<c,hasPreviousPage:r>1}},Y=(t={})=>{const[a,r]=o.useState(t),e=o.useCallback((n,c)=>{r(s=>({...s,[n]:c}))},[]),u=o.useCallback(n=>{r(c=>{const s={...c};return delete s[n],s})},[]),l=o.useCallback(()=>{r(t)},[t]),E=o.useCallback(()=>{const n=new URLSearchParams;return Object.entries(a).forEach(([c,s])=>{s!=null&&s!==""&&n.append(c,s)}),n.toString()},[a]);return{filters:a,updateFilter:e,removeFilter:u,clearFilters:l,buildQueryString:E}};export{i as V,x as a,y as b,Y as c,F as d,H as u};
