import{r as c,j as e}from"./index-BWBdPVw1.js";import{u as D,a as A,b as O,c as F,V as P}from"./useApiMethods-jYtKOT82.js";import{L as E}from"./LogicUtils-BHlKMc3t.js";const R=()=>{const{getMethod:o,loading:u,error:y}=D(),{buildUrl:x}=A(),{currentPage:n,pageSize:i,totalItems:g,setTotalItems:b,goToNextPage:j,goToPreviousPage:f,hasNextPage:N,hasPreviousPage:v}=O(1,10),{filters:r,updateFilter:l,clearFilters:S,buildQueryString:w}=F({status:"",currency:"",amount_gte:"",amount_lte:"",created_gte:"",created_lte:""}),[k,M]=c.useState([]),[s,h]=c.useState(null),m=c.useCallback(async()=>{try{const t=w(),a=x(P.V2_ORDERS_LIST,{methodType:"GET",queryParameters:`${t}&limit=${i}&offset=${(n-1)*i}`}),d=await o(a);d&&d.data&&(M(d.data),b(d.total_count||0))}catch(t){console.error("Error loading orders:",t)}},[o,x,w,i,n,b]);c.useEffect(()=>{m()},[m]);const T=c.useCallback(async t=>{try{const a=x(P.V2_ORDERS_LIST,{methodType:"GET",id:t}),d=await o(a);h(d)}catch(a){console.error("Error loading order details:",a)}},[o,x]),C=t=>{const a={succeeded:"text-green-600 bg-green-100",failed:"text-red-600 bg-red-100",pending:"text-yellow-600 bg-yellow-100",processing:"text-blue-600 bg-blue-100",cancelled:"text-gray-600 bg-gray-100"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a[t]||"text-gray-600 bg-gray-100"}`,children:(t==null?void 0:t.toUpperCase())||"UNKNOWN"})},_=(t,a)=>E.formatCurrency(t/100,a),p=t=>E.formatDate(t,"long");return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Órdenes de Pago"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona y monitorea todas las transacciones de pago"})]}),e.jsx("button",{onClick:m,disabled:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:u?"Cargando...":"Actualizar"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Filtros"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),e.jsxs("select",{value:r.status,onChange:t=>l("status",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"succeeded",children:"Exitoso"}),e.jsx("option",{value:"failed",children:"Fallido"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"processing",children:"Procesando"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda"}),e.jsxs("select",{value:r.currency,onChange:t=>l("currency",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"COP",children:"COP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto Mín."}),e.jsx("input",{type:"number",value:r.amount_gte,onChange:t=>l("amount_gte",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto Máx."}),e.jsx("input",{type:"number",value:r.amount_lte,onChange:t=>l("amount_lte",t.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Desde"}),e.jsx("input",{type:"date",value:r.created_gte,onChange:t=>l("created_gte",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Hasta"}),e.jsx("input",{type:"date",value:r.created_lte,onChange:t=>l("created_lte",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[e.jsx("button",{onClick:S,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Limpiar Filtros"}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Aplicar Filtros"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID de Pago"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Método de Pago"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"Cargando órdenes..."})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No se encontraron órdenes"})}):k.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.payment_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C(t.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_(t.amount,t.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.customer_id||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.payment_method||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p(t.created)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>T(t.payment_id),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Ver Detalles"})})]},t.payment_id))})]})}),g>0&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:f,disabled:!v,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsx("button",{onClick:j,disabled:!N,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando"," ",e.jsx("span",{className:"font-medium",children:(n-1)*i+1})," ","a"," ",e.jsx("span",{className:"font-medium",children:Math.min(n*i,g)})," ","de"," ",e.jsx("span",{className:"font-medium",children:g})," ","resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:f,disabled:!v,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Página ",n]}),e.jsx("button",{onClick:j,disabled:!N,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Siguiente"})]})})]})]})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Detalles del Pago: ",s.payment_id]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),e.jsx("div",{className:"mt-1",children:C(s.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Monto"}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:_(s.amount,s.currency)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente ID"}),e.jsx("div",{className:"mt-1",children:s.customer_id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Método de Pago"}),e.jsx("div",{className:"mt-1",children:s.payment_method||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de Creación"}),e.jsx("div",{className:"mt-1",children:p(s.created)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Última Actualización"}),e.jsx("div",{className:"mt-1",children:p(s.last_synced)})]})]}),s.description&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descripción"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-md",children:s.description})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>h(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Cerrar"})})]})})}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:y.message||"Ocurrió un error al cargar los datos"})]})})})]})};export{R as default};
